package io.github.mvrao94.kubeguard.integration.nvd;

import java.time.LocalDateTime;
import java.util.List;

/**
 * Represents a vulnerability from NIST NVD
 */
public class NvdVulnerability {
  
  private String cveId;
  private String description;
  private Double baseScore;
  private String baseSeverity;
  private LocalDateTime publishedDate;
  private LocalDateTime lastModifiedDate;
  private List<String> affectedProducts;
  private List<String> references;
  private List<String> cweIds;
  
  // CVSS metrics
  private String attackVector;
  private String attackComplexity;
  private String privilegesRequired;
  private String userInteraction;
  private String scope;
  private String confidentialityImpact;
  private String integrityImpact;
  private String availabilityImpact;
  
  public NvdVulnerability() {}

  // Getters and setters
  public String getCveId() {
    return cveId;
  }

  public void setCveId(String cveId) {
    this.cveId = cveId;
  }

  public String getDescription() {
    return description;
  }

  public void setDescription(String description) {
    this.description = description;
  }

  public Double getBaseScore() {
    return baseScore;
  }

  public void setBaseScore(Double baseScore) {
    this.baseScore = baseScore;
  }

  public String getBaseSeverity() {
    return baseSeverity;
  }

  public void setBaseSeverity(String baseSeverity) {
    this.baseSeverity = baseSeverity;
  }

  public LocalDateTime getPublishedDate() {
    return publishedDate;
  }

  public void setPublishedDate(LocalDateTime publishedDate) {
    this.publishedDate = publishedDate;
  }

  public LocalDateTime getLastModifiedDate() {
    return lastModifiedDate;
  }

  public void setLastModifiedDate(LocalDateTime lastModifiedDate) {
    this.lastModifiedDate = lastModifiedDate;
  }

  public List<String> getAffectedProducts() {
    return affectedProducts;
  }

  public void setAffectedProducts(List<String> affectedProducts) {
    this.affectedProducts = affectedProducts;
  }

  public List<String> getReferences() {
    return references;
  }

  public void setReferences(List<String> references) {
    this.references = references;
  }

  public List<String> getCweIds() {
    return cweIds;
  }

  public void setCweIds(List<String> cweIds) {
    this.cweIds = cweIds;
  }

  public String getAttackVector() {
    return attackVector;
  }

  public void setAttackVector(String attackVector) {
    this.attackVector = attackVector;
  }

  public String getAttackComplexity() {
    return attackComplexity;
  }

  public void setAttackComplexity(String attackComplexity) {
    this.attackComplexity = attackComplexity;
  }

  public String getPrivilegesRequired() {
    return privilegesRequired;
  }

  public void setPrivilegesRequired(String privilegesRequired) {
    this.privilegesRequired = privilegesRequired;
  }

  public String getUserInteraction() {
    return userInteraction;
  }

  public void setUserInteraction(String userInteraction) {
    this.userInteraction = userInteraction;
  }

  public String getScope() {
    return scope;
  }

  public void setScope(String scope) {
    this.scope = scope;
  }

  public String getConfidentialityImpact() {
    return confidentialityImpact;
  }

  public void setConfidentialityImpact(String confidentialityImpact) {
    this.confidentialityImpact = confidentialityImpact;
  }

  public String getIntegrityImpact() {
    return integrityImpact;
  }

  public void setIntegrityImpact(String integrityImpact) {
    this.integrityImpact = integrityImpact;
  }

  public String getAvailabilityImpact() {
    return availabilityImpact;
  }

  public void setAvailabilityImpact(String availabilityImpact) {
    this.availabilityImpact = availabilityImpact;
  }
  
  public boolean isKubernetesRelated() {
    if (description == null) return false;
    String lowerDesc = description.toLowerCase();
    return lowerDesc.contains("kubernetes") || 
           lowerDesc.contains("k8s") ||
           lowerDesc.contains("container") ||
           lowerDesc.contains("docker") ||
           lowerDesc.contains("pod");
  }
}
